import csv
def read_csv(filename):
   data = []
   with open(filename, 'r', encoding= 'utf-8') as file:
       reader = csv.DictReader(file)
       for row in reader:
           data.append(row)
   return data
def calc_average_yield_per_crop(data):
    totals = {}
    counts = {}
    for row in data: 
        crop = row['Crop']
        try: 
            yield_value = float(row['Yield_tons_per_hectare'])
        except:
            continue
        totals[crop] = totals.get(crop,0) + yield_value
        counts[crop] = counts.get(crop, 0) + 1
    averages = {}
    for crop in totals: 
        averages[crop] = totals[crop] / counts[crop]
